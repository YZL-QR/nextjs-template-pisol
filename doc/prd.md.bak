# 微信公众号编辑器 - 产品功能文档

## 产品概述
基于 Next.js + Shadcn-ui + Supabase 的微信公众号文章编辑器，集成AI写作助手功能，支持Markdown编辑、实时预览、语音输入、图片上传等功能。

关键的技术验收点：

1. 页面布局合理
2. AI对话可用（流式输出）
3. 支持语音转写输入
- 用于AI对话框
4. md编辑功能分为编辑区、预览渲染区
编辑区：实现md文本高亮渲染
预览区：确保md格式渲染正常
5. md层级格式快捷键
eg：Ctrl+ALt+1 --》 # 标题1
Ctrl+ALt+2 --》 ## 标题2
Ctrl+ALt+3 --》 ### 标题3
其他常用快捷键，按最佳实践设置。

6. 支持图片上传，md显示
在编辑区域，直接Ctrl+V粘贴图片，完成oss上传，和图床url显示
7. 草稿数据可保存，并存入supa数据库

## 核心功能模块

### 1. 文章编辑器
**功能描述：** 支持Markdown语法的富文本编辑器
- Markdown实时编辑
- 微信公众号样式预览
- 多主题切换（默认、优雅、科技、温馨）
- 格式化工具栏（标题、粗体、斜体、列表等）
- 快捷键支持

### 2. AI写作助手
**功能描述：** 集成通义千问API的智能写作助手
- 文章大纲生成
- 内容创作建议
- 文本优化润色
- 标题优化
- 实时对话交互
- 流式输出显示

### 3. 语音输入
**功能描述：** 支持语音转文字功能
- 实时语音录制
- 语音转文字（集成第三方API）
- 录制状态指示
- 音频数据处理

### 4. 图片管理
**功能描述：** 图片上传和管理功能
- 阿里云OSS图片上传
- 上传进度显示
- 图片URL自动插入
- 支持拖拽上传

### 5. 草稿管理
**功能描述：** 文章草稿的保存和管理
- 自动保存草稿
- 草稿列表查看
- 草稿搜索和筛选
- 收藏功能
- 草稿预览和编辑
- 草稿删除

### 6. 内容导出
**功能描述：** 多格式内容导出
- HTML格式复制
- Markdown文本复制
- 带样式HTML生成
- 微信公众号格式适配

## 用户操作路径设计

### 主要用户流程

#### 1. 新建文章流程
```
进入编辑器 → 选择主题 → 编辑内容 → 实时预览 → 保存草稿 → 复制发布
```

#### 2. AI辅助写作流程
```
打开AI助手 → 输入写作需求 → 获取AI建议 → 应用到编辑器 → 继续编辑
```

#### 3. 语音输入流程
```
点击语音按钮 → 开始录音 → 语音转文字 → 插入编辑器 → 继续编辑
```

#### 4. 图片插入流程
```
点击图片按钮 → 选择文件/拖拽上传 → 上传到OSS → 获取URL → 插入编辑器
```

#### 5. 草稿管理流程
```
草稿列表 → 搜索/筛选 → 选择草稿 → 预览/编辑 → 继续编辑/删除
```

## 页面结构设计

### 1. 主编辑页面 (`/`)
- **左侧面板：** AI聊天助手
- **中间区域：** Markdown编辑器
- **右侧面板：** 实时预览区域
- **顶部工具栏：** 格式化工具、主题切换、保存、复制等功能
- **底部状态栏：** 字数统计、保存状态

### 2. 草稿历史页面 (`/drafts-history`)
- **顶部操作栏：** 搜索框、筛选选项、刷新按钮
- **主内容区：** 草稿卡片列表
- **草稿卡片：** 标题、预览、字数、创建时间、操作按钮
- **预览弹窗：** 草稿内容预览和操作

## 交互设计要点

### 1. 响应式布局
- 支持可调整面板大小
- 移动端适配
- 面板显示/隐藏切换

### 2. 实时反馈
- Markdown实时预览
- AI对话流式显示
- 上传进度实时更新
- 保存状态提示

### 3. 快捷操作
- 键盘快捷键支持
- 右键菜单
- 拖拽操作
- 一键复制功能

### 4. 用户体验优化
- 加载状态指示
- 错误提示处理
- 操作确认对话框
- Toast消息提示

## 技术特性

### 1. 性能优化
- 组件懒加载
- 图片压缩上传
- 防抖输入处理
- 虚拟滚动（长列表）

### 2. 数据持久化
- Supabase数据库存储
- 本地缓存机制
- 自动保存功能
- 离线数据同步

### 3. 安全性
- API密钥环境变量管理
- 文件上传安全检查
- 用户输入验证
- XSS防护
